2024-08-27 19:06:17,173 INFO    MainThread:1638395 [wandb_setup.py:_flush():76] Current SDK version is 0.15.3
2024-08-27 19:06:17,181 INFO    MainThread:1638395 [wandb_setup.py:_flush():76] Configure stats pid to 1638395
2024-08-27 19:06:17,182 INFO    MainThread:1638395 [wandb_setup.py:_flush():76] Loading settings from /home/users/o/oleksiyu/.config/wandb/settings
2024-08-27 19:06:17,182 INFO    MainThread:1638395 [wandb_setup.py:_flush():76] Loading settings from /home/users/o/oleksiyu/WORK/hyperproject/wandb/settings
2024-08-27 19:06:17,182 INFO    MainThread:1638395 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-08-27 19:06:17,183 INFO    MainThread:1638395 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'twinturbo/scripts/full_run_group.py', 'program': '/home/users/o/oleksiyu/WORK/hyperproject/twinturbo/scripts/full_run_group.py'}
2024-08-27 19:06:17,183 INFO    MainThread:1638395 [wandb_setup.py:_flush():76] Applying login settings: {'api_key': '***REDACTED***'}
2024-08-27 19:06:17,183 INFO    MainThread:1638395 [wandb_setup.py:_flush():76] Applying login settings: {'api_key': '***REDACTED***'}
2024-08-27 19:06:17,184 INFO    MainThread:1638395 [wandb_init.py:_log_setup():507] Logging user logs to groups/twinturbo_reco_cons0.01_smls0.001_adv3_LHCO_CURTAINS2048b//run-TTS_1/wandb/run-20240827_190617-lop4rri4/logs/debug.log
2024-08-27 19:06:17,184 INFO    MainThread:1638395 [wandb_init.py:_log_setup():508] Logging internal logs to groups/twinturbo_reco_cons0.01_smls0.001_adv3_LHCO_CURTAINS2048b//run-TTS_1/wandb/run-20240827_190617-lop4rri4/logs/debug-internal.log
2024-08-27 19:06:17,184 INFO    MainThread:1638395 [wandb_init.py:init():547] calling init triggers
2024-08-27 19:06:17,185 INFO    MainThread:1638395 [wandb_init.py:init():554] wandb.init called with sweep_config: {}
config: {}
2024-08-27 19:06:17,185 INFO    MainThread:1638395 [wandb_init.py:init():596] starting backend
2024-08-27 19:06:17,185 INFO    MainThread:1638395 [wandb_init.py:init():600] setting up manager
2024-08-27 19:06:17,189 INFO    MainThread:1638395 [backend.py:_multiprocessing_setup():106] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-08-27 19:06:17,222 INFO    MainThread:1638395 [wandb_init.py:init():606] backend started and connected
2024-08-27 19:06:17,224 INFO    MainThread:1638395 [wandb_init.py:init():700] updated telemetry
2024-08-27 19:06:17,249 INFO    MainThread:1638395 [wandb_init.py:init():737] communicating run to backend with 60.0 second timeout
2024-08-27 19:06:17,754 INFO    MainThread:1638395 [wandb_run.py:_on_init():2177] communicating current version
2024-08-27 19:06:18,368 INFO    MainThread:1638395 [wandb_run.py:_on_init():2186] got version response upgrade_message: "wandb version 0.17.7 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-08-27 19:06:18,369 INFO    MainThread:1638395 [wandb_init.py:init():787] starting run threads in backend
2024-08-27 19:06:19,089 INFO    MainThread:1638395 [wandb_run.py:_console_start():2158] atexit reg
2024-08-27 19:06:19,089 INFO    MainThread:1638395 [wandb_run.py:_redirect():2013] redirect: SettingsConsole.WRAP_RAW
2024-08-27 19:06:19,090 INFO    MainThread:1638395 [wandb_run.py:_redirect():2078] Wrapping output streams.
2024-08-27 19:06:19,090 INFO    MainThread:1638395 [wandb_run.py:_redirect():2103] Redirects installed.
2024-08-27 19:06:19,092 INFO    MainThread:1638395 [wandb_init.py:init():829] run started, returning control to user process
2024-08-27 19:06:19,096 INFO    MainThread:1638395 [wandb_run.py:_config_callback():1286] config_cb None None {'model': {'reverse_pass_mode': 'additional_input', '_target_': 'twinturbo.src.models.twinturbo_model.TwinTURBO', 'use_m': True, 'encoder_mlp_config': {'hddn_dim': [64, 64, 64, 64], 'act_h': 'prelu'}, 'decoder_mlp_config': {'hddn_dim': [64, 64, 64, 64], 'act_h': 'prelu'}, 'latent_norm': True, 'latent_dim': 8, 'loss_cfg': {'reco': {'w': 1}, 'consistency_x': {'w': 0.01}, 'consistency_cont': {'w': 0.01}, 'second_derivative_smoothness': {'w': 0.001, 'step': 0.1}}, 'adversarial_cfg': {'discriminator': {'hddn_dim': [64, 64, 64, 64], 'act_h': 'prelu'}, 'optimizer_main': 'default.yaml', 'optimizer_d': 'default.yaml', 'warmup': 20, 'g_loss_weight': 0.2, 'every_n_steps_g': 1, 'train_dis_in_warmup': False, 'g_loss_weight_in_warmup': True}, 'valid_plots': False, 'optimizer': {'_target_': 'torch.optim.AdamW', '_partial_': True, 'lr': 0.0001, 'weight_decay': 1e-05}, 'scheduler': {'scheduler': {'_target_': 'torch.optim.lr_scheduler.CosineAnnealingLR', '_partial_': True, 'T_max': 100000, 'last_epoch': -1, 'eta_min': 0}, 'lightning': {'monitor': 'valid/log_prob', 'interval': 'step', 'frequency': 1}}}, 'project_name': 'twinTURBO_gauss_corr', 'network_name': 'twinturbo_reco_cons0.01_smls0.001_adv3_LHCO_CURTAINS2048b_2024-08-27_19-05-36-900316', 'ckpt_path': None, 'precision': 'high', 'compile': None, 'full_resume': False, 'seed': 1, 'automatic_optimization': False, 'callbacks': {'model_checkpoint': {'_target_': 'pytorch_lightning.callbacks.ModelCheckpoint', 'dirpath': 'groups/twinturbo_reco_cons0.01_smls0.001_adv3_LHCO_CURTAINS2048b//run-TTS_1/template/checkpoints', 'filename': 'min_val_loss_{epoch:03d}', 'monitor': 'valid/total_loss', 'mode': 'min', 'save_last': True, 'auto_insert_metric_name': False}, 'model_summary': {'_target_': 'pytorch_lightning.callbacks.RichModelSummary', 'max_depth': 2}, 'lr_monitor': {'_target_': 'pytorch_lightning.callbacks.LearningRateMonitor', 'logging_interval': 'step'}}, 'loggers': {'wandb': {'_target_': 'pytorch_lightning.loggers.wandb.WandbLogger', 'offline': True, 'id': None, 'log_model': False, 'project': 'twinTURBO_gauss_corr', 'name': 'twinturbo_reco_cons0.01_smls0.001_adv3_LHCO_CURTAINS2048b_2024-08-27_19-05-36-900316', 'save_dir': 'groups/twinturbo_reco_cons0.01_smls0.001_adv3_LHCO_CURTAINS2048b//run-TTS_1', 'resume': False}}, 'paths': {'output_dir': 'groups/twinturbo_reco_cons0.01_smls0.001_adv3_LHCO_CURTAINS2048b//run-TTS_1/template', 'root_dir': '/home/users/o/oleksiyu/WORK/hyperproject', 'full_path': 'groups/twinturbo_reco_cons0.01_smls0.001_adv3_LHCO_CURTAINS2048b//run-TTS_1/template', 'wandbkey': '/home/users/o/oleksiyu/WORK/keys/wandb.key'}, 'trainer': {'_target_': 'pytorch_lightning.Trainer', 'min_epochs': 1, 'max_epochs': 200, 'enable_progress_bar': True, 'accelerator': 'auto', 'devices': 1, 'precision': 32, 'check_val_every_n_epoch': 1, 'default_root_dir': 'groups/twinturbo_reco_cons0.01_smls0.001_adv3_LHCO_CURTAINS2048b//run-TTS_1/template'}, 'data': {'datamodule': {'_target_': 'twinturbo.src.data.data.SimpleDataModule', 'train_frac': 0.8, 'train_data': {'_target_': 'twinturbo.src.data.data.CombDataset', 'dataset1': {'_target_': 'twinturbo.src.data.data.InMemoryDataFrameDict', 'list_order': ['data', 'mass'], 'file_path': '/home/users/o/oleksiyu/scratch/DATA/LHCO/events_anomalydetection_v2.features_prepCURTAINS.h5', 'plotting_path': 'groups/twinturbo_reco_cons0.01_smls0.001_adv3_LHCO_CURTAINS2048b//run-TTS_1/plots/input/train_d1/', 'processor_cfg': [{'_target_': 'twinturbo.src.data.data.ProcessorSplitDataFrameVars', 'frame_name': 'df', 'new_df_dict': {'data': ['m_j1', 'del_m', 'del_R', 'tau21_j1', 'tau21_j2', 'm_jj'], 'is_signal': ['is_signal']}}, {'_target_': 'twinturbo.src.data.data.ProcessorApplyCuts', 'scalar_df_name': 'is_signal', 'cuts': ['is_signal == 0']}, {'_target_': 'twinturbo.src.data.data.ProcessorIntervals', 'scalar_df_name': 'data', 'var_name': 'm_jj', 'intervals': [[3000, 3300], [3700, 4600]]}, {'_target_': 'twinturbo.src.data.data.ProcessorCATHODE', 'frame_name': 'data', 'save_pkl': 'groups/twinturbo_reco_cons0.01_smls0.001_adv3_LHCO_CURTAINS2048b//run-TTS_1/cathode_preprocessor.pkl'}, {'_target_': 'twinturbo.src.data.data.ProcessorSplitDataFrameVars', 'frame_name': 'data', 'new_df_dict': {'data': ['m_j1', 'del_m', 'del_R', 'tau21_j1', 'tau21_j2', 'm_jj'], 'mass': ['m_jj']}}, {'_target_': 'twinturbo.src.data.data.ProcessorToFloat32', 'frame_names': ['data', 'mass']}]}, 'dataset2': {'_target_': 'twinturbo.src.data.data.InMemoryDataFrameDict', 'list_order': ['mass_add'], 'file_path': '/home/users/o/oleksiyu/scratch/DATA/LHCO/events_anomalydetection_v2.features_prepCURTAINS.h5', 'plotting_path': 'groups/twinturbo_reco_cons0.01_smls0.001_adv3_LHCO_CURTAINS2048b//run-TTS_1/plots/input/train_d2/', 'processor_cfg': [{'_target_': 'twinturbo.src.data.data.ProcessorSplitDataFrameVars', 'frame_name': 'df', 'new_df_dict': {'data': ['m_j1', 'del_m', 'del_R', 'tau21_j1', 'tau21_j2', 'm_jj'], 'is_signal': ['is_signal']}}, {'_target_': 'twinturbo.src.data.data.ProcessorApplyCuts', 'scalar_df_name': 'is_signal', 'cuts': ['is_signal == 0']}, {'_target_': 'twinturbo.src.data.data.ProcessorIntervals', 'scalar_df_name': 'data', 'var_name': 'm_jj', 'intervals': [[3000, 4600]]}, {'_target_': 'twinturbo.src.data.data.ProcessorCATHODE', 'frame_name': 'data', 'load_pkl': 'groups/twinturbo_reco_cons0.01_smls0.001_adv3_LHCO_CURTAINS2048b//run-TTS_1/cathode_preprocessor.pkl'}, {'_target_': 'twinturbo.src.data.data.ProcessorSplitDataFrameVars', 'frame_name': 'data', 'new_df_dict': {'mass_add': ['m_jj']}}, {'_target_': 'twinturbo.src.data.data.ProcessorToFloat32', 'frame_names': ['mass_add']}]}}, 'loader_kwargs': {'pin_memory': True, 'batch_size': 2048, 'num_workers': 8, 'drop_last': False}}}, 'model/params/total': 64519, 'model/params/trainable': 64519, 'model/params/non_trainable': 0}
